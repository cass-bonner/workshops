<html>
<meta>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="serverless.css" />
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
</meta>
<body background="images/background.png">
<script src="js/clipboard.js-master/dist/clipboard.min.js"></script>

    <script>
    var clipboard = new Clipboard('.btn');
    clipboard.on('success', function(e) {
        console.log(e);
    });
    clipboard.on('error', function(e) {
        console.log(e);
    });
    </script>

<table>
  <tr>
    <td align="left" width="25%"><img src="images/aws_icon.png"/></td>
    <td align = "center" width = "60%">
<listing class="pretext">
<font size="2">
  <table>
<tr>
<td width="100%"><a href="serverless_prerequisites.html">Serverless Workshop Prerequisites</a></td>
</tr>
<tr>
<td width="100%"><a href="serverless.html">Serverless Overview</a><br/></td>
</tr>
<tr>
<td width="100%"><a href="serverless-static-website.html">Serverless Static Webabb</a><br/></td>
</tr>
<tr>
<td width="100%"><a href="serverless-dynamic-website.html">Serverless Dynamic Webapp</a><br/></td>
</tr>
<tr>
<td width="100%"><a href="serverless-chatbot.html">Serverless Lex Chatbot</a><br/></td>
</tr></table>
</font size="2">
</listing>
    </td>
    <td align="right" width="25%"><img src="images/iag_icon.png"/></td>
 </tr>
</table>

<br/>
<br/>
<p ="font-family:verdana">
<h1 align="center">Serverless static website on AWS</h1>
<listing class="pretext">
<table cellpadding="20px"  align="center">
<tr>
<td width="50%"><img src="images/s3.png"/><br/><a href="http://docs.aws.amazon.com/AmazonS3/latest/gsg/GetStartedWithS3.html">Amazon S3</a></td>
<td width="50%"><img src="images/vue.png"/><br/><a href="https://vuejs.org/">Vue.js</a></td>
</tr>
</table>

</listing>
<listing class="pretext">
Lab Contents
<img src="images/bullet.png"> <a href="#overview">Overview</></a>
<img src="images/bullet.png"> <a href="#vue">vue.js & Setup</></a>
<img src="images/bullet.png"> <a href="#s3">Amazon S3</></a>
</listing>

<h4>Overview</h4>
<listing class="pretext">Serverless has many use cases as we have discussed, but is a great fit for building a webite. After all what do you need:

    <img src="images/serverless-arch.png" />

</listing>
<listing class="pretext">
We minimally need:
<ul>
<li> A User Interface (UI). Of course the solution will be different whether you want to build a traditional website intended for a browser, a native app for mobile phones, etc. For this workshop we'll just build basic html/javascript for a traditional website but the design would not vary significantly.  We will use <a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html">S3 (Simple Storage Service)</a> to serve our static file requests. In practice you'd likely want to include a <a href="http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/Introduction.html">Content Delivery Network (CDN)</a> such as AWS Cloud Front to serve the static files from Edge locations to provide better performance for the users. 
<li> Dynamic Components. The static files come from S3, but few websites only need static content. We might need to post data to our backend, or query data specific to a given user, or their particular request. We will use <a href="http://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html">Amazon API Gateway</a> to define the various dynamic use cases (APIs) for which we need to serve our pages in the next section of this workshop. We will use <a href="http://docs.aws.amazon.com/lambda/latest/dg/welcome.html">AWS Lambda</a> to run the dynamic logic/code to fulfill our requests, which does not require you to provision or manage servers, and manages resiliency and scale on your behalf.  We use <a href="http://docs.aws.amazon.com/step-functions/latest/dg/welcome.html">AWS Step Functions</a> to coordinate the components of distributed applications and microservices using visual workflows. 

  Enough reading, let's get started!
</listing>


<h4 id="vue">vue.js & setup</h4>
<listing class="pretext">Let's start by setting up a project in your local IDE (or you're welcome to work directly with an editor).</listing>
<ol type="1"><li><listing class="pretext">Navigate to the aws-serverless-workshop directory that you created in the <a href="serverless-prerequisites.html"> Prerequisites</a> - OR - setup a project pointing to this directory in your IDE.</li></listing>
<li><listing class="pretext">Let's start up the Vue dev mode server so that we can see our application. From directly within the aws-serverless-workshop, type:
  <button class="btn btn-outline-secondary btn-sm" data-clipboard-target="#startdev">Copy</button>
<pre><span id="startdev">

npm run dev

</span></pre>
This should start the Vue server and launch a Hello World Vue webapp that you saw when you performed the pre-requisites.  But let's brand our site and bring in some css that's more in line with what we want our website to look like. 
</li></listing>


<li><listing class="pretext">From a command prompt or terminal shell, Ensure you are in the aws-serverless-workshop directory. Let's first back up some files that we are about to overwrite so that we can understand what's changed:
<br/>
  <button class="btn btn-outline-secondary btn-sm" data-clipboard-target="#backup">Copy</button>
<pre><span id="backup">
cp index.html index.html.bak
cp src/App.vue src/App.vue.bak
cp src/components/Hello.vue src/components/Hello.vue.bak
cp src/router/index.js src/router/index.js.bak
</span></pre>
</li></listing>
<li><listing class="pretext">Now, run the following commands which will copy some updates to those two files as well as bring in some additional resources.

PLEASE ensure you are inside the aws-serverless-workshop when you run this command!

  <button class="btn btn-outline-secondary btn-sm" data-clipboard-target="#awscp">Copy</button>
<pre><span id="awscp">
aws s3 cp s3://aws-serverless-workshop/PetMatch/resources/index.html index.html 
aws s3 cp s3://aws-serverless-workshop/PetMatch/resources/App.vue src/App.vue
aws s3 cp s3://aws-serverless-workshop/PetMatch/resources/components/Hello.vue src/components/Hello.vue
aws s3 cp s3://aws-serverless-workshop/PetMatch/resources/router/index.js src/router/index.js
aws s3 cp s3://aws-serverless-workshop/PetMatch/resources/components/PetMatch.vue src/components/PetMatch.vue
aws s3 cp s3://aws-serverless-workshop/PetMatch/resources/components/PetMatch.vue.withCognito src/components/PetMatch.vue.withCognito
aws s3 cp s3://aws-serverless-workshop/PetMatch/resources/components/config.json src/components/config.json
aws s3 cp s3://aws-serverless-workshop/PetMatch/resources/assets/app.css src/assets
aws s3 cp --recursive s3://aws-serverless-workshop/PetMatch/resources/static static 
</span></pre>
</listing>
<li><listing class="pretext">
Optional: Now let's diff the files to see what's changed. (if on Windows try FC instead of diff and DEL instead of rm) 

 <button class="btn btn-outline-secondary btn-sm" data-clipboard-target="#diff">Copy</button>
<pre><span id="diff">
diff index.html index.html.bak
diff src/App.vue src/App.vue.bak
diff src/components/Hello.vue src/components/Hello.vue.bak
diff src/router/index.js src/router/index.js.bak
rm index.html.bak
rm src/App.vue.bak 
rm src/components/Hello.vue.bak
rm src/router/index.js.bak
</span></pre>
</listing></li>

<h4 id="s3">Amazon S3</h4>
<li><listing class="pretext">Now we have a simple static webapp utilizing a progressive framework that will help as we continue to build it out. Let's host our website on s3 now so it becomes a proper website not something running off our local drive.:) 

First we create an S3 bucket called [your unique id]-aws-serverless-workshop. You can do this via the AWS console or with the following CLI commands - but be sure to change [your unique id] with your login id at work (or other unique identifier). If you do it via the console be sure to configure it as a website with the index document as index.html and the error document as error.html.

NB: Ensure the region in your ~/.aws/config is set to the region in which you will be working. Recommendation is us-east

<br/>
 <button class="btn btn-outline-secondary btn-sm" data-clipboard-target="#mkbucket">Copy</button>
<pre><span id="mkbucket">

-aws s3 mb s3://[your unique id]-aws-serverless-workshop
-aws s3 website s3://[your unique id]-aws-serverless-workshop/ --index-document index.html --error-document error.html

</span></pre>
</listing></li>

<li><listing class="pretext">You may remember that we are running Vue.js in dev mode at this point. We need to convert it to prod mode before we deploy it. Back up out of the src directory into the 'aws-serverless-workshop'. With the next command we use 'npm run build' to build our Vue app in prod mode, and then we push it to our S3 bucket. Be sure to change [your unique id] to your actual unique id.
<br/>
 <button class="btn btn-outline-secondary btn-sm" data-clipboard-target="#prd">Copy</button>
<pre><span id="prd">

npm run build && aws s3 sync dist s3://[your unique id]-aws-serverless-workshop --acl public-read

</span></pre>
</listing></li>


<li><listing class="pretext">Now navigate to the console and find your S3 bucket. Select  your bucket and click on properties.  Click Static Website Hosting and copy your URL. You should see a page that looks like this:

<img src="images/vue-app-screenshot.png"/>

Note that this technique of deploying via cli is handy for POCs and isolated development but in practice you would commit your changes to source control repository and utilize CI/CD tooling to drive your full build pipeline.

</listing></li>
</ol>
<br/>
<br/>

Cool? Well not really as it's not really doing much. So <a href="serverless-dynamic-website.html"/>&nbsp;&nbsp;&nbsp;&lt;Now let's create the dynamic components&gt;</a>
</body>
</html>
</ol>
</ol>
</ol>
</ol>
